#  2019长安杯Wp

> 老规矩～让我来看看
>
> 看看必考题～以及看看创新题～脑洞题
>
> Wp地址：https://forensics.xidian.edu.cn/wiki/2019caWriteUp/#part-3

因为本人为2021年参赛选手

所以没法复现以及只有猜当时的情况

若有不当～敬请谅解～

## Part 1

> 看样子会有个exe叫做取证大师

###  “检材 1.E01”镜像的 SHA256 值

> 取证大师加载，右键计算`SHA256`

###  该分区内开始的逻辑区块地址

> 逻辑区块地址是描述计算机存储设备上数据所在区块的通用机制，一般用在像硬盘这样的辅助记忆设备。
>
> 选中 分区2 -> 摘要 -> 查看 物理位置
>
> 但是这个内存物理地址的单位是字节`（Byte）`，而一个逻辑区块占用512位，**所以要将这个值除以512**
>
> 这个除以512学到了

###  `root` 逻辑卷的文件系统/大小

> 选中 分区2 -> 摘要 -> 查看 分区类型
>
> 选中 分区2 -> 摘要 -> 查看 设备大小
>
> 大小换算这个就不说了吧

###  针对服务器

- 请找出该服务器的网站访问端口是什么？

直接贴的答案，我猜的是：应该仍然是nginx的话

那么就去找到`nginx/conf.d`查看下怎么配置的

- 该服务器中运行了 `docker`应用，在本地有多少 `docker`镜像？

有docker应用，说明该linux是直接可以进入docker操作的

```bash
# 启动docker服务
systemctl start docker
# 查看所有的容器命令
docker ps -a
```

- 其中一台容器`ID` 为 `15debb1824e6`的容器节点，它运行了什么服务？

> 这个要么能看到简介要么进去看看

```bash
# 进入容器
docker exec -it 容器id /bin/bash
```

- 上题容器节点中，占用了主机的哪个端口?

> 这个进入到容器里面
>
> 去看配置应该就行了

- 该服务器中网站运行在 `docker` 容器中，其中 `web`服务使用的是什么应用？

> 都到1202年了，一般都是nginx了吧
>
> 但是根据nginx方法没找到，去搜搜其他服务器的默认路径/方法

- 所述运行 `web` 服务的容器节点，使用的镜像名称是什么？

```bash
# 列出本机已有的镜像
docker image ls

# REPOSITORY: 来自于哪个仓库；

# 获取镜像的详细信息
docker inspect xxxx
```

- 上题所述容器节点占用的容器端口是什么？

> 分清楚谁映射谁就好了

- 该 `docker`应用的 `server`版本是多少？
- 该 `docker` 应用中总共有多少容器节点？
- 运行中的容器节点有多少？

> `docker info` 搞定
>
> 这里我吐槽下：
>
> 节点（Node）：一个节点是一个运行 Kubernetes 中的主机。
>
> 很明显Wp上的运行中为3个，选D我就没懂啦～

- 网站目录所在的容器内部路径为（格式：容器 ID：路径）

```bash
# 启动docker服务
systemctl start docker
# 查看所有的容器命令
docker ps -a
# 进入容器
docker exec -it 容器id /bin/bash
# 到对应的路径下去找
```

- 网站目录所在的主机路径为下列选项中的哪个？
- 网站日志的路径在哪？
- 案发当时，该服务器的原始 `IP` 地址是多少？

> 这里用的是取证大师
>
> 但是正常的操作也能实现～
>
> 就不多BB了

- 在 `docker` 中，各容器节点和主机之间的网络连接模式是什么？
- 当我们想将网站重构好时，访问网站时，web 应用在其中承担什么样的工作？
- 从网站日志中，我们可以看到嫌疑人入侵服务器所使用的 IP 是

> 这里考的偏概念。
>
> 连接模式就像你的电脑跟虚拟机一样～一般都是桥接
>
> web应用这我没太懂，我怎么感觉是方向代理
>
> 入侵的IP那个不就是你这台主机日志中从哪里来的IP（bushi
>
> 日志： 来自的IP+时间+请求方式+请求路径～

- 网站目录中网站的主配置文件是哪一个？
- 该网站使用的是什么数据库？

>Wp: 根目录应该在`home`文件夹下，查看`README.md`文件
>
>好家伙～nodejs不太熟悉 但是寻思不应该选mongodb吗？（挺潮流的哈

- 所使用数据库的端口是多少
- 数据库所在服务器 IP 是多少
- 数据库的用户名是什么
- 数据库的密码是什么
- 该网站所使用的数据库库名是什么

> 端口号默认就是：27017 应该不会改～
>
> Wp那个链接mongodb的url直接暴露了所有嘛～
>
> 百度自己搜一下mongodb链接语句 python里面也是这样 基础～

- 在案发时，黑客对该服务器某个文件/目录进行了加密，请问是哪个文件/目录？

> 我没看懂Wp，但是试试每个编辑下 哪个打不开就是了

## Part 2

###  后端MongoDb

- 该数据库服务器使用数据库的安装路径在哪？
- 数据库的配置文件的路径？
- 数据库的日志文件路径在哪里？

> mongo基础
>
> 因为是选择题直接去看看就好了
>
> 然后确定了是mongo 可以看看或者自己下个mongo看看他的配置文件

- 该数据库的网站用户表名是什么
- 该数据库中网站用户表里的密码字段加密方式是
- 该用户表被做过什么样的修改？
- 嫌疑人对该数据库的哪个库进行了风险操作
- 嫌疑人对上述数据库做了什么样的风险操作

```bash
# 启动mongo
mongod --dbpath 存放数据的文件夹

# 展示数据库
show dbs
```

> 就可以看到对应的表名，只要不是乱命名就行
>
> 做了什么修改～ 看log就行了

- 嫌疑人在哪个时间段内登陆数据库？
- 嫌疑人在什么时间对数据库进行了 42 题所述的风险操作？

> （怎么考这么多mongo的阅读呀
>
> 这里只要会看日志： 时间+操作 明白每条语句的含义 就好了

## Part3

###  VPN的天下

> 你扣押获得了一台嫌疑人使用过的 VPN 服务器
>
> 这个我不太熟悉具体的原理了。 我们看看有什么花样

- 该服务器所使用的 VPN 软件，采用了什么协议
- 该服务器的时区为
- 该服务器中对 VPN 软件配置的 option 的文件位置在哪里？
- `VPN` 软件开启了写入客户端的连接与断开，请问写入的文件是哪个？
- `VPN` 软件客户端被分配的 IP 范围是
- 由 `option` 文件可以知道，`option` 文件配置了 `VPN` 软件的日志路径为

> 关于VPN的加密比较好理解,就是加密你的数据,防止被中间人窃取。
>
> 但是普通的VPN协议由于流量特征明显,所以很容易被防火长城识破。
>
> 为此在原来的基础上增加了混淆进行伪装,
>
> 可以简单的理解成,将VPN这跟管道刷上了迷彩,不容易被人发现。

[参考链接](https://qiangwaikan.com/vpn-protocol/)🔗 讲了下这几个选项的区别

> - 做题的时候我也没啥办法判断～我觉得要么选现在最好的，要么原来比较稳定的
>
> - 时区的话看看：more /etc/sysconfig/clock
>
> - option 的文件在哪里 根据选择去看看呗～
>
> - 写入哪个文件啥的 去找到的配置文件里面去看看就好了
> - 范围看样子 也在配置文件里面
> - 日志路径 那肯定就是在配置文件里面

看了Wp 解题思路就是**history**看看操作的历史记录来找答案

然后找到配置文件再去搜罗 （Wp的顺手好多呀

（懂了 以后做数据取证也是顺手～

- `VPN` 软件记录了客户端使用的名称和密码，记录的文件是（每个搜一下）
- 在服务器时间`2019-07-02_02:08:27`登陆过`VPN`客户端的用户名是哪个？
- 上题用户登陆时的客户`IP`是什么？
- 通过 `IP172.16.80.188`登陆`VPN`服务器的用户名是哪个？
- 上题用户登陆 `VPN`服务器的北京时间是

> 这个坑 离谱～ 北京时间
>
> 查这些肯定要到日志里面去
>
> 根据上面的题提示：
>
> - 记录了客户端使用的名称和密码： chap-secrets
> - `option` 文件配置了 `VPN` 软件的日志路径 ： /var/log/

- 该服务器曾被进行过抓包，请问 `network.cap`是对哪个网卡进行抓包获得的抓包文件
- 对 `ens37` 网卡进行抓包产生的抓包文件并保存下来的是哪个？

> 这个问题一时间蒙蔽了
>
> 看了Wp 发现确实要巧用history
>
> - history ｜ grep 'network.cap'
> - history ｜ grep 'ens37'

- 从保存的数据包中分析可知，出口的 `IP` 

> wireshark 都来了我是没想到了～搁这做杂项呢～
>
> Wp说的比较清楚了～不多赘述

## Part 4

###  Windows

- 找出该系统最后一次正常关机时间
- 该系统于 2019 年 7 月 13 日安装的软件为
- 找出该嫌疑人于 2019-07-13 17:52:19 时，使用 WinRAR 工具访问了_____文件
- 系统于 `2019-07-13 17:53:45`时运行了___程序
- 文件`test2-master.zip`是什么时间下载到本机的
- 文件 `test2-master.zip` 是使用什么工具下载到本地的
- 嫌疑人成功连接至 `192.168.184.128`服务器的时间为

> [参考链接](https://jingyan.baidu.com/article/e52e36156894d540c60c51f6.html)🔗
>
> - 一个是查看日志-》系统
> - 一个是取证大师弄的？ 相同的在机器的日志里面肯定也查得到
> - 也是取证大师？ 用户痕迹-〉Win时间轴
> - 这个就是我在20的Wp中说的pf文件
> - 下载文件一般都是默认储存在“下载”文件夹下（bushi～
> - 看选项去找
> - 还是取证大师？上网记录

###  取证大师YYDS

> 取证大师也是个工具🔧 同样的在主机里面也能找到

- 嫌疑人通过远程连接到 `128` 服务器，下载了什么文件到本机
- 承接上一题，下载该文件用了多长时间
- 请计算该下载文件的 sha256 值

> 取证大师搜索🔍：`.tar.gz`
>
> 创建时间-修改时间 = 下载时间

- 请分析并提取，嫌疑人所用的手机的`IMEI`号码(盲区)

> **国际移动设备识别码**（**International Mobile Equipment Identity**，**IMEI**），
>
> 即通常所说的手机序列号、手机“串号”，
>
> 用于在移动电话网络中识别每一部独立的手机等移动通信设备，
>
> 相当于移动电话的身份证。

后面的看Wp吧 取证大师+火眼  电脑+手机 YYDS







